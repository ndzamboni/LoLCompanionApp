{{> header}}

<h1>{{searchResult.name}}</h1>
<p>{{searchResult.address}}</p>
<h2>Reviews ({{reviews.length}})</h2>
<ul>
  {{#each reviews}}
    <li>
      {{this.content}} - <strong>{{this.User.username}}</strong>
      <ul>
        {{#each this.Comments}}
          <li>{{this.content}} - <strong>{{this.User.username}}</strong></li>
        {{/each}}
      </ul>
      {{#if ../user}}
        <form action="/comments" method="POST">
          <input type="hidden" name="reviewId" value="{{this.id}}">
          <textarea name="content" rows="2" required></textarea>
          <button type="submit">Add Comment</button>
        </form>
        {{#ifEquals this.user_id ../user.id}}
          <form action="/reviews/{{this.id}}" method="POST" class="delete-form">
            <input type="hidden" name="_method" value="DELETE">
            <button type="submit">Delete Review</button>
          </form>
        {{/ifEquals}}
      {{/if}}
    </li>
  {{/each}}
</ul>

<h2>Leave a Review</h2>
<form action="/reviews" method="POST">
  <input type="hidden" name="placeId" value="{{searchResult.place_id}}">
  <div class="form-group">
    <label for="rating-cleanliness">Cleanliness</label>
    <input type="number" name="rating[cleanliness]" min="1" max="5" required>
  </div>
  <div class="form-group">
    <label for="rating-accessibility">Accessibility</label>
    <input type="number" name="rating[accessibility]" min="1" max="5" required>
  </div>
  <div class="form-group">
    <label for="rating-privacy_security">Privacy & Security</label>
    <input type="number" name="rating[privacy_security]" min="1" max="5" required>
  </div>
  <div class="form-group">
    <label for="rating-convenience">Convenience</label>
    <input type="number" name="rating[convenience]" min="1" max="5" required>
  </div>
  <div class="form-group">
    <label for="rating-customer_only_use">Customer Only Use</label>
    <input type="checkbox" name="rating[customer_only_use]">
  </div>
  <div class="form-group">
    <label for="comment">Comment</label>
    <textarea name="comment" rows="4"></textarea>
  </div>
  <button type="submit" class="btn btn-primary">Submit Review</button>
</form>

{{> footer}}
